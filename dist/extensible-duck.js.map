{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap d08e53f013ccb61d9894","webpack:///./src/extensible-duck.js"],"names":["typeValue","namespace","store","type","zipObject","keys","values","arguments","length","result","i","buildTypes","types","map","isObject","obj","isFunction","func","isUndefined","value","undefined","isPlainObject","constructor","Object","mergeDeep","target","sources","source","shift","Array","isArray","push","key","Error","assignDefaults","options","consts","creators","selectors","injectDuck","input","duck","Function","constructLocalized","derivedSelectors","deriveSelectors","localizedSelectors","forEach","selector","globalState","args","composedSelectors","Selector","extractFunction","Duck","initialState","name","reducer","bind","state","action","parent","parentCreators"],"mappings":"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","file":"extensible-duck.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Duck\"] = factory();\n\telse\n\t\troot[\"Duck\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap d08e53f013ccb61d9894","function typeValue(namespace, store, type) {\n  return `${namespace}/${store}/${type}`\n}\n\nfunction zipObject (keys, values) {\n  if (arguments.length == 1) {\n    values = keys[1];\n    keys = keys[0];\n  }\n    \n  var result = {};\n  var i = 0;\n  \n  for (i; i < keys.length; i += 1) {\n    result[keys[i]] = values[i];\n  }\n  \n  return result;\n};\n\nfunction buildTypes(namespace, store, types) {\n  return zipObject(\n    types,\n    types.map(type => typeValue(namespace, store, type))\n  )\n}\n\nfunction isObject(obj) {\n    return obj !== null && typeof obj === 'object';\n}\n\nfunction isFunction(func){\n   return func !== null && typeof func === 'function';\n}\n\nfunction isUndefined(value){\n   return typeof value === 'undefined' || value === undefined;\n}\n\nfunction isPlainObject(obj) {\n    return isObject(obj) && (\n        obj.constructor === Object  // obj = {}\n        || obj.constructor === undefined // obj = Object.create(null)\n    );\n}\n\nfunction mergeDeep(target, ...sources) {\n    if (!sources.length) return target;\n    const source = sources.shift();\n\n    if(Array.isArray(target)) {\n        if(Array.isArray(source)) {\n            target.push(...source);\n        } else {\n            target.push(source);\n        }\n    } else if(isPlainObject(target)) {\n        if(isPlainObject(source)) {\n            for(let key of Object.keys(source)) {\n                if(!target[key]) {\n                    target[key] = source[key];\n                } else {\n                    mergeDeep(target[key], source[key]);\n                }\n            }\n        } else {\n            throw new Error(`Cannot merge object with non-object`);\n        }\n    } else {\n        target = source;\n    }\n\n    return mergeDeep(target, ...sources);\n};\n\nfunction assignDefaults(options) {\n  return {\n    ...options,\n    consts: options.consts || {},\n    creators: options.creators || (() => ({})),\n    selectors: options.selectors || {},\n    types: options.types || [],\n  }\n}\n\nfunction injectDuck(input, duck) {\n  if (input instanceof Function) {\n    return input(duck)\n  } else {\n    return input\n  }\n}\n\nexport function constructLocalized(selectors) {\n  const derivedSelectors = deriveSelectors(selectors)\n  return (duck) => {\n    const localizedSelectors = {}\n    Object.keys(derivedSelectors).forEach(key => {\n      const selector = derivedSelectors[key]\n      localizedSelectors[key] = (globalState, ...args) => selector(globalState[duck.store], globalState, ...args)\n    })\n    return localizedSelectors\n  }\n}\n\n/**\n * Helper utility to assist in composing the selectors.\n * Previously defined selectors can be used to derive future selectors.\n * \n * @param {object} selectors \n * @returns \n */\nfunction deriveSelectors(selectors) {\n  const composedSelectors = {}\n  Object.keys(selectors).forEach(key => {\n    const selector = selectors[key]\n    if(selector instanceof Selector) {\n      composedSelectors[key] = (...args) =>\n        (composedSelectors[key] = selector.extractFunction(composedSelectors))(...args)\n    }\n    else {\n      composedSelectors[key] = selector\n    }\n  })\n  return composedSelectors\n}\n\nexport default class Duck {\n  constructor(options) {\n    options = assignDefaults(options)\n    const {\n      namespace,\n      store,\n      types,\n      consts,\n      initialState,\n      creators,\n      selectors,\n    } = options\n    this.options = options\n    Object.keys(consts).forEach(name => {\n      this[name] = zipObject(consts[name], consts[name])\n    })\n\n    this.store = store\n    this.types = buildTypes(namespace, store, types)\n    this.initialState = isFunction(initialState)\n      ? initialState(this)\n      : initialState\n    this.reducer = this.reducer.bind(this)\n    this.selectors = deriveSelectors(injectDuck(selectors, this))\n    this.creators = creators(this)\n  }\n  reducer(state, action) {\n    if (isUndefined(state)) {\n      state = this.initialState\n    }\n    return this.options.reducer(state, action, this)\n  }\n  extend(options) {\n    if (isFunction(options)) {\n      options = options(this)\n    }\n    options = assignDefaults(options)\n    const parent = this.options\n    let initialState\n    if (isFunction(options.initialState)) {\n      initialState = duck => options.initialState(duck, this.initialState)\n    } else if (isUndefined(options.initialState)) {\n      initialState = parent.initialState\n    } else {\n      initialState = options.initialState\n    }\n    return new Duck({\n      ...parent,\n      ...options,\n      initialState,\n      consts: mergeDeep({}, parent.consts, options.consts),\n      creators: duck => {\n        const parentCreators = parent.creators(duck)\n        return { ...parentCreators, ...options.creators(duck, parentCreators) }\n      },\n      selectors: (duck) => ({ ...injectDuck(parent.selectors, duck), ...injectDuck(options.selectors, duck) }),\n      types: [...parent.types, ...options.types],\n      reducer: (state, action, duck) => {\n        state = parent.reducer(state, action, duck)\n        if (isUndefined(options.reducer)) {\n          return state\n        } else {\n          return options.reducer(state, action, duck)\n        }\n      },\n    })\n  }\n}\n\nexport class Selector {\n  constructor(func) {\n    this.func = func\n  }\n\n  extractFunction(selectors) {\n    return this.func(selectors)\n  }\n}\n\nDuck.Selector = Selector\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/extensible-duck.js"],"sourceRoot":""}